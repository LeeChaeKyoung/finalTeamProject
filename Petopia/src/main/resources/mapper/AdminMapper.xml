<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.campus.myapp.dao.AdminDAO">

 	<select id="animalInfoList" resultType="com.campus.myapp.vo.AnimalInfoVO">
		select category,breed from animalinfo
		<if test='searchKey == "all" and searchWord == null'>
		</if>
		<if test='searchKey != "all" and searchWord == null'>
			where category like '${searchKey}'
		</if>
		<if test='searchKey != "all" and searchWord != null'>
			where category like '${searchKey}' and breed like '%${searchWord}%'
		</if>
		<if test='searchKey == "all" and searchWord != null'>
			where breed like '%${searchWord}%'
		</if>
		 order by category
		 limit ${onePageRecord} offset ${offsetIndex}
	</select>
	<select id="animalInfoTotalRecord" resultType="int">
		select count(breed) cnt from animalinfo
		<if test='searchKey == "all" and searchWord == null'>
		</if>
		<if test='searchKey != "all" and searchWord == null'>
			where category like '${searchKey}'
		</if>
		<if test='searchKey != "all" and searchWord != null'>
			where category like '${searchKey}' and breed like '%${searchWord}%'
		</if>
		<if test='searchKey == "all" and searchWord != null'>
			where breed like '%${searchWord}%'
		</if>
	</select>
	<insert id="animalInfoInsert">
		insert into animalinfo(category, breed, content, filename1, filename2, filename3, distinction, disease)
		value(#{category}, #{breed}, #{content}, #{filename1}, #{filename2}, #{filename3}, #{distinction}, #{disease})
	</insert>
	
	<select id="animalInfoGetFileName" resultType="com.campus.myapp.vo.AnimalInfoVO">
		select filename1, filename2, filename3 from animalinfo where breed=#{param1}
	</select>
	
	<delete id="animalInfoDataDelete">
		delete from animalinfo where breed=#{param1}
	</delete>
	
	<select id="animalInfoEditView" resultType="com.campus.myapp.vo.AnimalInfoVO">
		select category,breed,content,filename1,filename2,filename3,distinction,disease 
		from animalinfo where breed=#{param1}
	</select>
	
	<update id="animalInfoUpdate">
		update animalinfo set category=#{category}, content=#{content}, 
		distinction=#{distinction}, disease=#{disease}
		, filename1=#{filename1}, filename2=#{filename2}, filename3=#{filename3}
		where breed=#{breed}
	</update>
	
	
	<select id="memberList" resultType="com.campus.myapp.vo.MemberVO">
		select userid, username, useremail, userlevel, kakaoid from member
		<if test='searchWord != null'>
			where ${searchKey} like '%${searchWord}%'
		</if>
		order by userlevel
		limit ${onePageRecord} offset ${offsetIndex}
	</select>
	
	<select id="memberTotalRecord" resultType="int">
		select count(userid) cnt from member
		<if test='searchWord != null'>
			where ${searchKey} like '%${ searchWord}%'
		</if>
	</select>
	
	<delete id="memberDelete">
		delete from member where userid=#{userid}
	</delete>
	<update id="memberChangeAdmin">
		update member set userlevel='1', stopend=null  where userid=#{userid}
	</update>
	<update id="memberChangeNormal">
		update member set userlevel='2', stopend=null  where userid=#{userid}
	</update>
	<update id="memberChangeStop">
		update member set userlevel='3', stopend=date_add(now(), interval 1 week) where userid=#{userid}
	</update>
	
	<select id="totalMemberCnt" resultType="int">
		select count(userid) cnt from member
	</select>
	<select id="level1MemberCnt" resultType="int">
		select count(userid) cnt from member where userlevel="1"
	</select>
	<select id="level2MemberCnt" resultType="int">
		select count(userid) cnt from member where userlevel="2"
	</select>
	<select id="level3MemberCnt" resultType="int">
		select count(userid) cnt from member where userlevel="3"
	</select>
	
	<select id="totalAnimalInfoCnt" resultType="int">
		select count(breed) cnt from animalinfo
	</select>
	<select id="dogInfoCnt" resultType="int">
		select count(breed) cnt from animalinfo where category="강아지"
	</select>
	<select id="catInfoCnt" resultType="int">
		select count(breed) cnt from animalinfo where category="고양이"
	</select>
	<select id="reptileInfoCnt" resultType="int">
		select count(breed) cnt from animalinfo where category="파충류,양서류"
	</select>
	<select id="birdInfoCnt" resultType="int">
		select count(breed) cnt from animalinfo where category="조류"
	</select>
	<select id="etcInfoCnt" resultType="int">
		select count(breed) cnt from animalinfo where category="기타"
	</select>
</mapper>
