<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.campus.myapp.dao.BoardDAO">
  	<!-- 글등록 -->
  	<insert id="BoardInsert">
  	INSERT INTO board(userid, title, content,boardtype,filename1)
  	VALUES(#{userid}, #{title}, #{content}, #{boardtype}, #{filename1})
  	</insert>
  	<!--  글목록 불러오기 -->
  	<select id="BoardList" resultType="com.campus.myapp.vo.BoardVO">
  	SELECT A.boardno, A.title, A.userid, A.content, A.hit, A.writedate, A.filename1,
  		   B.profileimage, B.userlevel
  	FROM   board A, member B
  	WHERE  A.userid=B.userid 
	AND    A.boardtype=${param1}
	<if test="searchWord != null">and ${searchKey} like '%${searchWord}%' </if>
				order by no desclimit ${onePageRecord} offset ${offsetIndex} 
  	</select>
  	<select id="totalRecord" resultType="int">
    SELECT count(boardno) as cnt from board
    WHERE boardtype=${param1}
  	  <if test="searchWord != null">and ${searchKey} like '%${searchWord}%' </if>
    </select>
  	<!--  글 1개 선택 -->
  	<select id="BoardSelect" resultType="com.campus.myapp.vo.BoardVO">
  	SELECT boardno, title, userid, content, hit, writedate
  	FROM board
  	WHERE boardno = ${param1}
  	</select>
  	<select id="BoardNum" resultType="int"><!--  숫자 입력용  -->
  	SELECT boardno FROM board WHERE userid=#{param1} ORDER BY board_num DESC LIMIT 1;
  	</select>
  	<!--  조회수 증가 -->
  	<update id="hitCount">
    UPDATE board SET hit = hit+1 WHERE boardno=#{param1}
    </update>
  	<select id="BoardView" resultType="com.campus.myapp.vo.BoardVO">
	    SELECT A.boardno, A.title, A.hit, A.writedate, A.content, A.userid, A.filename1,
	   		   B.profileimage, B.userlevel
	    FROM   board A, member B
	    WHERE  A.userid=B.userid 
	    AND    A.boardno=${param1}
    </select>
  	
  </mapper>